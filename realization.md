# Витрина RFM

## 1.1. Выясните требования к целевой витрине.

**Что сделать**: построить витрину данных для RFM-классификации пользователей приложения на основе успешно выполненных заказов. Витрину нужно назвать dm_rfm_segments. Сохранить в схему analysis хранилища данных. Успешный заказ - заказ со статусом Closed

**Зачем**: подготовить данные для компании-разработчика приложения по доставке еды.

**За какой период**: 2022 год.

**Обновление данных**: не требуется.

**Кому доступна**: всем, но доступ только на чтение

**Необходимая структура**:

    1. user_id - идентификатор пользователя
    2. recency - фактор давности, количество прошедшего времени с момента последнего успешного заказа. 
                 Число от 1 до 5, где 1 - заказов вообще не было или были очень давно, а 5 - заказы были относительно недавно

    3. frequency - фактор частоты, количество успешных заказов.
                   Число от 1 до 5, где 1 - наименьшее количество заказов, 5 - наибольшее

    4. monetary_value - фактор денежной ценности, сумма затрат клиента на успешные заказы.
                        Число от 1 до 5, где 1 - наименьшая сумма, 5 - наибольшая  


## 1.2. Изучите структуру исходных данных.


## 1.3. Проанализируйте качество данных

Результаты представлены в файле data_quality.md


## 1.4. Подготовьте витрину данных

### 1.4.1. Сделайте VIEW для таблиц из базы production.

Результаты представлены в файле views.sql

### 1.4.2. Напишите DDL-запрос для создания витрины.

Результаты представлены в файле datamart_dll.sql

### 1.4.3. Напишите SQL запрос для заполнения витрины

Результаты представлены в файлах:

  - tmp_rfm_recency.sql
  - tmp_rfm_frequency.sql
  - tmp_rfm_monetary_value.sql


## 2. Доработка представлений

Результаты представлены в файле orders_view.sql